<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>3D Carousel with Logo</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar fixed-top navbar-expand-lg  navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand ms-4 te" href="#">SJ developers</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavDropdown">
                <ul class="navbar-nav mx-auto ">
                    <li class="nav-item ">
                        <a class="nav-link" aria-current="page" href="#">Our Project</a>
                    </li>
                    <li class="nav-item ">
                        <a class="nav-link" href="#">Partnerships</a>
                    </li>
                    <li class="nav-item ">
                        <a class="nav-link" href="#">Contact us</a>
                    </li>
                    <li class="nav-item ">
                        <a class="nav-link" href="#">About us</a>
                    </li>
                </ul>
                
                <ul class="navbar-nav me-4 ">
                    <li class="nav-item dropdown border rounded rounded-7 explore text-center">
                        <a class="nav-link dropdown-toggle text-light" href="#" id="navbarDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Explore
                        </a>
                        <ul class="dropdown-menu text-center" aria-labelledby="navbarDropdownMenuLink">
                            <li><a class="dropdown-item text-light" href="#">Action</a></li>
                            <li><a class="dropdown-item text-light" href="#">Another action</a></li>
                            <li><a class="dropdown-item text-light" href="#">Something</a></li>
                        </ul>
                    </li>
                </ul>
        </div>
    </nav>
    <img src="assets/left.svg" alt="" class="fixed-bottom">
    <img src="assets/right.svg" alt="" class="right">
    <script type="module">
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x71A274, 1); // Set background color to greenish
        document.body.appendChild(renderer.domElement);

        camera.position.z = 4.5;

        // Lighting
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.2);
        scene.add(ambientLight);

        const directionalLight = new THREE.DirectionalLight(0xffffff, 3.5);
        directionalLight.position.set(5, 10, 7.5);
        scene.add(directionalLight);

        const loader = new GLTFLoader();
        let logo;
        loader.load('logo.gltf', (gltf) => {
            logo = gltf.scene;
            logo.position.set(0, 0, 0);
            adjustLogoScale();
            scene.add(logo);
        }, undefined, (error) => {
            console.error(error);
        });

        const images = [];
        const imageCount = 8; // Number of images in the carousel

        function getResponsiveRadius() {
            return Math.max(2, Math.min((window.innerWidth / 1800) * 3)); // Decrease radius as screen width decreases, minimum radius of 1.5
        }

        function getResponsiveImageSize() {
            const baseWidth = 1.4;
            const baseHeight = 1.1;
            const scaleFactor = Math.min(window.innerWidth / 200, window.innerHeight / 700);
            return {
                width: baseWidth * scaleFactor,
                height: baseHeight * scaleFactor,
            };
        }

        function adjustLogoScale() {
            const scaleFactor = Math.min(window.innerWidth , window.innerHeight / 500);
            if (logo) {
                logo.scale.set(scaleFactor * 30, scaleFactor * 30, scaleFactor * 30);
            }
        }

        function createCarousel() {
            const radius = getResponsiveRadius();
            images.forEach(mesh => scene.remove(mesh)); // Remove existing images
            images.length = 0; // Clear the array

            for (let i = 0; i < imageCount; i++) {
                const texture = new THREE.TextureLoader().load(`assets/image2.jpg`);
                const material = new THREE.MeshBasicMaterial({ map: texture });
                const { width, height } = getResponsiveImageSize();
                const geometry = new THREE.PlaneGeometry(width, height);
                const mesh = new THREE.Mesh(geometry, material);

                const angle = (i / imageCount) * Math.PI * 2;
                const x = radius * Math.cos(angle);
                const z = radius * Math.sin(angle);
                const y = -0.5 * Math.sin(angle); // Tilted axis

                mesh.position.set(x, y, z);
                mesh.material.transparent = true;
                mesh.material.opacity = 0; // Initially invisible
                images.push(mesh);
                scene.add(mesh);
            }
        }

        function adjustImageProperties(image, transitionFactor) {
            // Apply opacity smoothly
            const opacityFactor = 1.3 * transitionFactor;
            image.material.opacity = opacityFactor;
            image.material.transparent = true; // Ensure transparency is enabled
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            adjustLogoScale();
            createCarousel();
        }

        window.addEventListener('resize', onWindowResize);

        function animate() {
            requestAnimationFrame(animate);

            const rotationSpeed = scrollFactor; // Adjust speed as needed

            // Rotate the logo
            if (logo) {
                logo.rotation.y = -(rotationSpeed * Math.PI * 3);
            }

            // Rotate the carousel
            const radius = getResponsiveRadius();
            for (let i = imageCount - 1; i >= 0; i--) {
                const image = images[i];
                const angle = (scrollFactor + i * (1 / imageCount)) * Math.PI * 2;
                const x = radius * Math.cos(angle);
                const z = radius * Math.sin(angle);
                const y = -0.7 * Math.sin(angle); // Tilted axis

                image.position.set(x, y, z);

                // Calculate visibility based on scroll factor
                const startAppear = (imageCount - 1 - i) / imageCount; // When the image starts to appear
                const endAppear = (imageCount - i - 0.5) / imageCount; // When the image is fully visible
                const transitionFactor = Math.max(0, Math.min(1, (scrollFactor - startAppear) / (endAppear - startAppear)));

                // Calculate visibility based on angle
                const cameraAngle = Math.atan2(y, z - 1);
                const angleFactor = 1 - Math.abs(cameraAngle / (Math.PI / 2));

                // Combine both factors
                const finalTransitionFactor = transitionFactor * angleFactor;

                adjustImageProperties(image, finalTransitionFactor);
            }

            renderer.render(scene, camera);
        }

        let scrollFactor = 0;
        window.addEventListener('scroll', () => {
            const maxScroll = document.documentElement.scrollHeight - window.innerHeight;
            scrollFactor = window.scrollY / maxScroll;
        });

        createCarousel();
        animate();
    </script>
</body>
</html>


